<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>phi.vis API documentation</title>
<meta name="description" content="Visualization: plotting, interactive user interfaces …">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>phi.vis</code></h1>
</header>
<section id="section-intro">
<p>Visualization: plotting, interactive user interfaces.</p>
<p>Use <code><a title="phi.vis.view" href="#phi.vis.view">view()</a></code> to show fields or field variables in an interactive user interface.</p>
<p>Use <code><a title="phi.vis.plot" href="#phi.vis.plot">plot()</a></code> to plot fields using Matplotlib.</p>
<p>See the user interface documentation at <a href="https://tum-pbs.github.io/PhiFlow/Visualization.html">https://tum-pbs.github.io/PhiFlow/Visualization.html</a></p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="phi.vis.action"><code class="name flex">
<span>def <span class="ident">action</span></span>(<span>fun)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="phi.vis.close"><code class="name flex">
<span>def <span class="ident">close</span></span>(<span>figure=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Close and destroy a figure.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>figure</code></strong></dt>
<dd>(Optional) A figure that was created using <code><a title="phi.vis.plot" href="#phi.vis.plot">plot()</a></code>.
If not specified, closes the figure created most recently.</dd>
</dl></div>
</dd>
<dt id="phi.vis.control"><code class="name flex">
<span>def <span class="ident">control</span></span>(<span>value, range: tuple = None, description='', **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Mark a variable as controllable by any GUI created via <code><a title="phi.vis.view" href="#phi.vis.view">view()</a></code>.</p>
<p>Example:</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; dt = control(1.0, (0.1, 10), name=&quot;Time increment (dt)&quot;)
</code></pre>
<p>This will cause a control component (slider, checkbox, text field, drop-down, etc.) to be generated in the user interface.
Changes to that component will immediately be reflected in the Python variable assigned to the control.
The Python variable will always hold a primitive type, such as <code>int</code>, <code>float´,</code>bool<code> or </code>str`.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong></dt>
<dd>Initial value. Must be either <code>int</code>, <code>float</code>, <code>bool</code> or <code>str</code>.</dd>
<dt><strong><code>range</code></strong></dt>
<dd>(Optional) Specify range of possible values as <code>(min, max)</code>. Only for <code>int</code>, <code>float</code> and <code>str</code> values.</dd>
<dt><strong><code>description</code></strong></dt>
<dd>Human-readable description.</dd>
<dt><strong><code>**kwargs</code></strong></dt>
<dd>Additional arguments to determine the appearance of the GUI component,
e.g. <code>rows</code> for text fields or <code>log=False</code> for float sliders.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code>value</code></p></div>
</dd>
<dt id="phi.vis.load_scalars"><code class="name flex">
<span>def <span class="ident">load_scalars</span></span>(<span>scene: phi.field._scene.Scene, name: str, prefix='log_', suffix='.txt', x: Optional[str] = 'steps', entries_dim=(iterationˢ=None), batch_dim=(batchᵇ=None))</span>
</code></dt>
<dd>
<div class="desc"><p>Read one or a <code>Tensor</code> of scalar logs as curves.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>scene</code></strong></dt>
<dd><code>Scene</code> or <code>str</code>. Directory containing the log files.</dd>
<dt><strong><code>name</code></strong></dt>
<dd>Log file base name.</dd>
<dt><strong><code>prefix</code></strong></dt>
<dd>Log file prefix.</dd>
<dt><strong><code>suffix</code></strong></dt>
<dd>Log file suffix.</dd>
<dt><strong><code>x</code></strong></dt>
<dd>'steps'
or 'time'</dd>
<dt><strong><code>entries_dim</code></strong></dt>
<dd>Curve dimension.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code>Tensor</code> containing <code>entries_dim</code> and <code>vector</code>.</p></div>
</dd>
<dt id="phi.vis.overlay"><code class="name flex">
<span>def <span class="ident">overlay</span></span>(<span>*fields: Union[phi.field._field.Field, phi.geom._geom.Geometry, phiml.math._tensors.Tensor]) ‑> phiml.math._tensors.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Specify that multiple fields should be drawn on top of one another in the same figure.
The fields will be plotted in the order they are given, i.e. the last field on top.</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; plot(vis.overlay(heatmap, points, velocity))
</code></pre>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>*fields</code></strong></dt>
<dd><code>Field</code> or <code>Tensor</code> instances</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Plottable object</p></div>
</dd>
<dt id="phi.vis.plot"><code class="name flex">
<span>def <span class="ident">plot</span></span>(<span>*fields: Union[phi.field._field.Field, phiml.math._tensors.Tensor, phi.geom._geom.Geometry, list, tuple, dict], lib: Union[str, phi.vis._vis_base.PlottingLibrary] = None, row_dims: Union[str, tuple, list, set, ForwardRef('Shape'), Callable] = None, col_dims: Union[str, tuple, list, set, ForwardRef('Shape'), Callable] = &lt;function batch&gt;, animate: Union[str, tuple, list, set, ForwardRef('Shape'), Callable] = None, overlay: Union[str, tuple, list, set, ForwardRef('Shape'), Callable] = 'overlay', title: Union[str, phiml.math._tensors.Tensor, list, tuple] = None, size=(12, 5), same_scale: Union[bool, phiml.math._shape.Shape, tuple, list, str] = True, log_dims: Union[str, phiml.math._shape.Shape, tuple, list] = '', show_color_bar=True, color: Union[str, int, phiml.math._tensors.Tensor, list, tuple] = None, alpha: Union[float, phiml.math._tensors.Tensor, list, tuple] = 1.0, err: Union[float, phiml.math._tensors.Tensor, list, tuple] = 0.0, frame_time=100, repeat=True, plt_params: Dict = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Creates one or multiple figures and sub-figures and plots the given fields.</p>
<p>To show the figures, use <code><a title="phi.vis.show" href="#phi.vis.show">show()</a></code>.</p>
<p>The arguments <code>row_dims</code>, <code>col_dims</code>, <code>animate</code> and <code><a title="phi.vis.overlay" href="#phi.vis.overlay">overlay()</a></code> control how data is presented.
Each accepts dimensions as a <code>str</code>, <code>Shape</code>, tuple, list or type function.
In addition to the dimensions present on the data to be plotted, the dimensions <code>args</code> is created if multiple arguments are passed,
and <code>tuple</code>, <code>list</code>, <code>dict</code> are generated for corresponding objects to be plotted.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>fields</code></strong></dt>
<dd>Fields or Tensors to plot.</dd>
<dt><strong><code>lib</code></strong></dt>
<dd>Plotting library name or reference. Valid names are <code>'matplotlib'</code>, <code>'plotly'</code> and <code>'console'</code>.</dd>
<dt><strong><code>row_dims</code></strong></dt>
<dd>Batch dimensions along which sub-figures should be laid out vertically.
<code>Shape</code> or comma-separated names as <code>str</code>, <code>tuple</code> or <code>list</code>.</dd>
<dt><strong><code>col_dims</code></strong></dt>
<dd>Batch dimensions along which sub-figures should be laid out horizontally.
<code>Shape</code> or comma-separated names as <code>str</code>, <code>tuple</code> or <code>list</code>.</dd>
<dt><strong><code>title</code></strong></dt>
<dd><code>str</code> for figures with a single subplot.
For subplots, pass a string <code>Tensor</code> matching the content dimensions, i.e. <code>row_dims</code> and <code>col_dims</code>.
Passing a <code>tuple</code>, <code>list</code> or <code>dict</code>, will create a tensor with these names internally.</dd>
<dt><strong><code>size</code></strong></dt>
<dd>Figure size in inches, <code>(width, height)</code>.</dd>
<dt><strong><code>same_scale</code></strong></dt>
<dd>Whether to use the same axis limits for all sub-figures.</dd>
<dt><strong><code>log_dims</code></strong></dt>
<dd>Dimensions for which the plot axes should be scaled logarithmically.
Can be given as a comma-separated <code>str</code>, a sequence of dimension names or a <code>Shape</code>.
Use <code>'_'</code> to scale unnamed axes logarithmically, e.g. the y-axis of scalar functions.</dd>
<dt><strong><code>show_color_bar</code></strong></dt>
<dd>Whether to display color bars for heat maps.</dd>
<dt><strong><code>color</code></strong></dt>
<dd><code>Tensor</code> of line / marker colors.
The color can be specified either as a cycle index (int tensor) or as a hex code (str tensor).
The color of different lines and markers can vary.</dd>
<dt><strong><code>alpha</code></strong></dt>
<dd>Opacity as <code>float</code> or <code>Tensor</code>.
This affects all elements, not only line plots.
Opacity can vary between lines and markers.</dd>
<dt><strong><code>err</code></strong></dt>
<dd>Expected deviation from the value given in <code>fields</code>.
For supported plots, adds error bars of size <em>2·err</em>.
If the plotted data is the mean of some distribution, a good choice for <code>err</code> is the standard deviation along the mean dims.</dd>
<dt><strong><code>animate</code></strong></dt>
<dd>Time dimension to animate.
If not present in the data, will produce a regular plot instead.</dd>
<dt><strong><code>overlay</code></strong></dt>
<dd>Dimensions along which elements should be overlaid in the same subplot.
The default is only the <code><a title="phi.vis.overlay" href="#phi.vis.overlay">overlay()</a></code> dimension which is created by <code><a title="phi.vis.overlay" href="#phi.vis.overlay">overlay()</a></code>.</dd>
<dt><strong><code>frame_time</code></strong></dt>
<dd>Interval between frames in the animation.</dd>
<dt><strong><code>repeat</code></strong></dt>
<dd>Whether the animation should loop.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code>Tensor</code> of figure objects.
The tensor contains those dimensions of <code>fields</code> that were not reduced by <code>row_dims</code>, <code>col_dims</code> or <code>animate</code>.
Currently, only single-figure plots are supported.</p>
<p>In case of an animation, a displayable animation object will be returned instead of a <code>Tensor</code>.</p></div>
</dd>
<dt id="phi.vis.plot_scalars"><code class="name flex">
<span>def <span class="ident">plot_scalars</span></span>(<span>scene: Union[str, tuple, list, phi.field._scene.Scene, phiml.math._tensors.Tensor], names: Union[str, phiml.math._tensors.Tensor, list, tuple] = None, reduce: Union[str, phiml.math._shape.Shape, tuple, list] = 'names', down='', smooth=1, smooth_alpha=0.2, smooth_linewidth=2.0, size=(8, 6), transform: Callable = None, tight_layout=True, grid: Union[str, dict] = 'y', log_scale='', legend='upper right', x='steps', xlim=None, ylim=None, titles=True, labels: phiml.math._tensors.Tensor = None, xlabel: str = None, ylabel: str = None, colors: phiml.math._tensors.Tensor = 'default', dashed: phiml.math._tensors.Tensor = False)</span>
</code></dt>
<dd>
<div class="desc"><h2 id="args">Args</h2>
<dl>
<dt><strong><code>scene</code></strong></dt>
<dd><code>str</code> or <code>Tensor</code>. Scene paths containing the data to plot.</dd>
<dt><strong><code>names</code></strong></dt>
<dd>Data files to plot for each scene. The file must be located inside the scene directory and have the name <code>log_&lt;name&gt;.txt</code>.</dd>
<dt><strong><code>reduce</code></strong></dt>
<dd>Tensor dimensions along which all curves are plotted in the same diagram.</dd>
<dt><strong><code>down</code></strong></dt>
<dd>Tensor dimensions along which diagrams are ordered top-to-bottom instead of left-to-right.</dd>
<dt><strong><code>smooth</code></strong></dt>
<dd><code>int</code> or <code>Tensor</code>. Number of data points to average, -1 for all.</dd>
<dt><strong><code>smooth_alpha</code></strong></dt>
<dd>Opacity of the non-smoothed curves under the smoothed curves.</dd>
<dt><strong><code>smooth_linewidth</code></strong></dt>
<dd>Line width of the smoothed curves.</dd>
<dt><strong><code>size</code></strong></dt>
<dd>Figure size in inches.</dd>
<dt><strong><code>transform</code></strong></dt>
<dd>Function <code>T(x,y) -&gt; (x,y)</code> transforming the curves.</dd>
<dt>tight_layout:</dt>
<dt>grid:</dt>
<dt>log_scale:</dt>
<dt>legend:</dt>
<dt>x:</dt>
<dt>xlim:</dt>
<dt>ylim:</dt>
<dt>titles:</dt>
<dt>labels:</dt>
<dt>xlabel:</dt>
<dt>ylabel:</dt>
<dt><strong><code>colors</code></strong></dt>
<dd>Line colors as <code>str</code>, <code>int</code> or <code>Tensor</code>. Integers are interpreted as indices of the default color list.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>MatPlotLib <a href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure">figure</a></p></div>
</dd>
<dt id="phi.vis.savefig"><code class="name flex">
<span>def <span class="ident">savefig</span></span>(<span>path: str, figure=None, dpi=120.0, close=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Save a figure to an image file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>figure</code></strong></dt>
<dd>Matplotlib or Plotly figure or text.</dd>
<dt><strong><code>path</code></strong></dt>
<dd>File path.</dd>
<dt><strong><code>dpi</code></strong></dt>
<dd>Pixels per inch.</dd>
<dt><strong><code>close</code></strong></dt>
<dd>Whether to close the figure after saving it.</dd>
</dl></div>
</dd>
<dt id="phi.vis.show"><code class="name flex">
<span>def <span class="ident">show</span></span>(<span>*model: Union[phi.vis._vis_base.VisModel, phi.field._field.Field, phiml.math._tensors.Tensor, phi.geom._geom.Geometry, list, tuple, dict], play=True, gui: Union[phi.vis._vis_base.Gui, str] = None, lib: Union[phi.vis._vis_base.Gui, str] = None, keep_alive=True, **config)</span>
</code></dt>
<dd>
<div class="desc"><p>If <code>model</code> is a user interface model, launches the registered user interface.
This will typically be the Dash web interface or the console interface if dash is not available.
This method prepares the <code>model</code> before showing it. No more fields should be added to the vis after this method is invoked.</p>
<p>See Also:
<code><a title="phi.vis.view" href="#phi.vis.view">view()</a></code>.</p>
<p>If <code>model</code> is plottable, e.g. a <code>Field</code> or <code>Tensor</code>, a figure is created and shown.
If <code>model</code> is a figure, it is simply shown.</p>
<p>See Also:
<code><a title="phi.vis.plot" href="#phi.vis.plot">plot()</a></code>.</p>
<p>This method may block until the GUI or plot window is closed.</p>
<p>Also see the user interface documentation at <a href="https://tum-pbs.github.io/PhiFlow/Visualization.html">https://tum-pbs.github.io/PhiFlow/Visualization.html</a></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>model</code></strong></dt>
<dd>(Optional) <code>VisModel</code>, the application or plottable object to display.
If unspecified, shows the most recently plotted figure.</dd>
<dt><strong><code>play</code></strong></dt>
<dd>If true, invokes <code>App.play()</code>. The default value is False unless "autorun" is passed as a command line argument.</dd>
<dt><strong><code>gui</code></strong></dt>
<dd>Deprecated. Use <code>lib</code> instead. (optional) class of GUI to use</dd>
<dt><strong><code>lib</code></strong></dt>
<dd>Gui class or plotting library as <code>str</code>, e.g. <code>'matplotlib'</code> or <code>'plotly'</code></dd>
<dt><strong><code>keep_alive</code></strong></dt>
<dd>Whether the GUI keeps the vis alive. If <code>False</code>, the program will exit when the main script is finished.</dd>
<dt><strong><code>**config</code></strong></dt>
<dd>additional GUI configuration parameters.
For a full list of parameters, see the respective GUI documentation at <a href="https://tum-pbs.github.io/PhiFlow/Visualization.html">https://tum-pbs.github.io/PhiFlow/Visualization.html</a></dd>
</dl></div>
</dd>
<dt id="phi.vis.smooth"><code class="name flex">
<span>def <span class="ident">smooth</span></span>(<span>curves: phiml.math._tensors.Tensor, n: int, ext: phiml.math.extrapolation.Extrapolation = &lt;phiml.math.extrapolation._SymmetricGradientExtrapolation object&gt;) ‑> phiml.math._tensors.Tensor</span>
</code></dt>
<dd>
<div class="desc"><p>Applies a smoothing kernel to curves, all channels independently.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>curves</code></strong></dt>
<dd><code>Tensor</code> containing at least one spatial dimension</dd>
<dt><strong><code>n</code></strong></dt>
<dd>Kernel size, i.e. number of values to average.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Smoothed curves as <code>Tensor</code></p></div>
</dd>
<dt id="phi.vis.view"><code class="name flex">
<span>def <span class="ident">view</span></span>(<span>*fields: Union[str, phi.field._field.Field], play: bool = True, gui=None, name: str = None, description: str = None, scene: Union[bool, phi.field._scene.Scene] = False, keep_alive=True, select: Union[str, tuple, list] = '', framerate=None, namespace=None, log_performance=True, **config) ‑> phi.vis._viewer.Viewer</span>
</code></dt>
<dd>
<div class="desc"><p>Show <code>fields</code> in a graphical user interface.</p>
<p><code>fields</code> may contain instances of <code>Field</code> or variable names of top-level variables (main module or Jupyter notebook).
During loops, e.g. <code><a title="phi.vis.view" href="#phi.vis.view">view()</a>.range()</code>, the variable status is tracked and the GUI is updated.</p>
<p>When called from a Python script, name and description may be specified in the module docstring (string before imports).
The first line is interpreted as the name, the rest as the subtitle.
If not specified, a generic name and description is chosen.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>*fields</code></strong></dt>
<dd>(Optional) Contents to be displayed. Either variable names or values.
For field instances, all variables referencing the value will be shown.
If not provided, the user namespace is searched for Field variables.</dd>
<dt><strong><code>play</code></strong></dt>
<dd>Whether to immediately start executing loops.</dd>
<dt><strong><code>gui</code></strong></dt>
<dd>(Optional) Name of GUI as <code>str</code> or GUI class.
Built-in GUIs can be selected via <code>'dash'</code>, <code>'console'</code>.
See <a href="https://tum-pbs.github.io/PhiFlow/Visualization.html">https://tum-pbs.github.io/PhiFlow/Visualization.html</a></dd>
<dt><strong><code>name</code></strong></dt>
<dd>(Optional) Name to display in GUI and use for the output directory if <code>scene=True</code>.
Will be generated from the top-level script if not provided.</dd>
<dt><strong><code>description</code></strong></dt>
<dd>(Optional) Description to be displayed in the GUI.
Will be generated from the top-level script if not provided.</dd>
<dt><strong><code>scene</code></strong></dt>
<dd>Existing <code>Scene</code> to write into or <code>bool</code>. If <code>True</code>, creates a new Scene in <code>~/phi/&lt;name&gt;</code></dd>
<dt><strong><code>keep_alive</code></strong></dt>
<dd>Whether the GUI should keep running even after the main thread finishes.</dd>
<dt><strong><code>framerate</code></strong></dt>
<dd>Target frame rate in Hz. Play will not step faster than the framerate. <code>None</code> for unlimited frame rate.</dd>
<dt><strong><code>select</code></strong></dt>
<dd>Dimension names along which one item to show is selected.
Dimensions may be passed as <code>tuple</code> of <code>str</code> or as comma-separated names in a single <code>str</code>.
For each <code>select</code> dimension, an associated selection slider will be created.</dd>
<dt><strong><code>log_performance</code></strong></dt>
<dd>Whether to measure and log the time each step takes.
If <code>True</code>, will be logged as <code>step_time</code> to <code>log_step_time.txt</code>.</dd>
<dt><strong><code>**config</code></strong></dt>
<dd>Additional GUI configuration arguments.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code><a title="phi.vis.Viewer" href="#phi.vis.Viewer">Viewer</a></code></p></div>
</dd>
<dt id="phi.vis.write_image"><code class="name flex">
<span>def <span class="ident">write_image</span></span>(<span>path: str, figure=None, dpi=120.0, close=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Save a figure to an image file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>figure</code></strong></dt>
<dd>Matplotlib or Plotly figure or text.</dd>
<dt><strong><code>path</code></strong></dt>
<dd>File path.</dd>
<dt><strong><code>dpi</code></strong></dt>
<dd>Pixels per inch.</dd>
<dt><strong><code>close</code></strong></dt>
<dd>Whether to close the figure after saving it.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="phi.vis.Viewer"><code class="flex name class">
<span>class <span class="ident">Viewer</span></span>
</code></dt>
<dd>
<div class="desc"><p>Shows variables from the user namespace.
To create a <code><a title="phi.vis.Viewer" href="#phi.vis.Viewer">Viewer</a></code>, call <code><a title="phi.vis.view" href="#phi.vis.view">view()</a></code> from the top-level Python script or from a notebook.</p>
<p>Use <code><a title="phi.vis.Viewer.range" href="#phi.vis.Viewer.range">Viewer.range()</a></code> to control the loop execution from the user interface.</p>
<p>Also see the user interface documentation at <a href="https://tum-pbs.github.io/PhiFlow/Visualization.html">https://tum-pbs.github.io/PhiFlow/Visualization.html</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Viewer(VisModel):
    &#34;&#34;&#34;
    Shows variables from the user namespace.
    To create a `Viewer`, call `phi.vis.view()` from the top-level Python script or from a notebook.

    Use `Viewer.range()` to control the loop execution from the user interface.

    Also see the user interface documentation at https://tum-pbs.github.io/PhiFlow/Visualization.html
    &#34;&#34;&#34;

    def __init__(self,
                 namespace: UserNamespace,
                 fields: dict,
                 name: str,
                 description: str,
                 scene: Scene,
                 controls: tuple,
                 actions: dict,
                 log_performance: bool,
                 ):
        VisModel.__init__(self, name, description, scene=scene)
        self.initial_field_values = fields
        self._controls = controls
        self.namespace = namespace
        self.log_performance = log_performance
        self._rec = None
        self._in_loop = False
        self._log = SceneLog(self.scene)
        self.log_file = self._log.log_file
        self._elapsed = None
        self.reset_step = 0
        self._actions = {}
        custom_reset = False
        self.reset_count = 0
        for action, function in actions.items():
            if action.name == &#39;reset&#39;:
                self._actions[action] = partial(self.reset, custom_reset=function)
                custom_reset = True
            else:
                self._actions[action] = function
        if not custom_reset:
            self._actions[Action(&#39;reset&#39;, Viewer.reset.__doc__)] = self.reset

    def log_scalars(self, reduce=math.mean, **values):
        self._log.log_scalars(self.steps, reduce=reduce, **values)

    def info(self, message: str):  # may be replaced by a different solution later on
        &#34;&#34;&#34;
        Update the status message.
        The status message is written to the console and the log file.
        Additionally, it may be displayed by the user interface.

        See `debug()`.

        Args:
            message: Message to display
        &#34;&#34;&#34;
        message = str(message)
        self.message = message
        self._log.log(message)

    def __rrshift__(self, other):
        self.info(other)

    @property
    def field_names(self) -&gt; tuple:
        return tuple(self.initial_field_values.keys())

    def get_field(self, name, dim_selection: dict) -&gt; Field:
        if name not in self.initial_field_values:
            raise KeyError(name)
        if self._rec:
            value = self._rec[name]
        else:
            value = self.namespace.get_variable(name)
        if callable(value):
            value = value()
        if isinstance(value, (Field, Tensor)):
            value = value[dim_selection]
        return value

    @property
    def curve_names(self) -&gt; tuple:
        return self._log.scalar_curve_names

    def get_curve(self, name: str) -&gt; tuple:
        return self._log.get_scalar_curve(name)

    @property
    def controls(self) -&gt; Tuple[Control]:
        return self._controls

    def get_control_value(self, name):
        return self.namespace.get_variable(name)

    def set_control_value(self, name, value):
        self.namespace.set_variable(name, value)

    @property
    def actions(self) -&gt; tuple:
        return tuple(self._actions.keys())

    def run_action(self, name):
        for action, fun in self._actions.items():
            if action.name == name:
                fun()
                return
        raise KeyError(name)

    def range(self, *args, warmup=0, **rec_dim):
        &#34;&#34;&#34;
        Similarly to `range()`, returns a generator that can be used in a `for` loop.

        &gt;&gt;&gt; for step in ModuleViewer().range(100):
        &gt;&gt;&gt;     print(f&#39;Running step {step}&#39;)

        However, `Viewer.range()` enables controlling the flow via the user interface.
        Each element returned by the generator waits for `progress` to be invoked once.

        Note that `step` is always equal to `Viewer.steps`.

        This method can be invoked multiple times.
        However, do not call this method while one `range` is still active.

        Args:
            *args: Either no arguments for infinite loop or single `int` argument `stop`.
                Must be empty if `rec_dim` is used.
            **rec_dim: Can be used instead of `*args` to record values along a new batch dimension of this name.
                The recorded values can be accessed as `Viewer.rec.&lt;name&gt;` or `Viewer.rec[&#39;&lt;name&gt;&#39;]`.
            warmup: Number of uncounted loop iterations to perform before `step()` is invoked for the first time.

        Yields:
            Step count of `Viewer`.
        &#34;&#34;&#34;
        for _ in range(warmup):
            yield self.steps

        self._in_loop = True
        self._call(self.progress_available)

        if rec_dim:
            assert len(rec_dim) == 1, f&#34;Only one rec_dim allowed but got {rec_dim}&#34;
            assert not args, f&#34;No positional arguments are allowed when a rec_dim is specified. {rec_dim}&#34;
            rec_dim_name = next(iter(rec_dim.keys()))
            size = rec_dim[rec_dim_name]
            assert isinstance(size, int)
            self._rec = Record(rec_dim_name)
            self._rec.append(self.initial_field_values, warn_missing=False)
            args = [size]
            self.growing_dims = [rec_dim_name]

        if len(args) == 0:
            def count():
                i = 0
                while True:
                    yield i
                    i += 1

            step_source = count()
        else:
            step_source = range(*args)

        try:
            for step in step_source:
                self.steps = step - self.reset_step
                try:
                    self._pre_step()
                    t = time.perf_counter()
                    yield step - self.reset_step
                    self._elapsed = time.perf_counter() - t
                    self.steps = step - self.reset_step + 1
                    if rec_dim:
                        self._rec.append({name: self.namespace.get_variable(name) for name in self.field_names})
                    if self.log_performance:
                        self._log.log_scalars(self.steps, reduce=None, step_time=self._elapsed)
                finally:
                    self._post_step()
        finally:
            self._in_loop = False
            self._call(self.progress_unavailable)

    def _pre_step(self):
        self._call(self.pre_step)

    def _post_step(self):
        self._call(self.post_step)

    @property
    def rec(self) -&gt; &#39;Record&#39;:
        &#34;&#34;&#34;
        Read recorded fields as `viewer.rec.&lt;name&gt;`.
        Accessing `rec` without having started a recording using `Viewer.range()` raises an `AssertionError`.
        &#34;&#34;&#34;
        assert self._rec, &#34;Enable recording by calling range() with a dimension name, e.g. &#39;range(frames=10)&#39;.&#34;
        return self._rec

    def progress(self):
        raise AssertionError(&#34;progress() not supported by synchronous Viewer.&#34;)

    @property
    def can_progress(self) -&gt; bool:
        return self._in_loop

    def reset(self, custom_reset=None):
        &#34;&#34;&#34;
        Restores all viewed fields to the states they were in when the viewer was created.
        Changes variable values in the user namespace.
        &#34;&#34;&#34;
        if custom_reset:
            custom_reset()
        for name, value in self.initial_field_values.items():
            self.namespace.set_variable(name, value)
        self.reset_step += self.steps
        self.steps = 0
        self.reset_count += 1</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>phi.vis._vis_base.VisModel</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li>phi.vis._viewer.AsyncViewer</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="phi.vis.Viewer.rec"><code class="name">prop <span class="ident">rec</span> : Record</code></dt>
<dd>
<div class="desc"><p>Read recorded fields as <code>viewer.rec.&lt;name&gt;</code>.
Accessing <code>rec</code> without having started a recording using <code><a title="phi.vis.Viewer.range" href="#phi.vis.Viewer.range">Viewer.range()</a></code> raises an <code>AssertionError</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def rec(self) -&gt; &#39;Record&#39;:
    &#34;&#34;&#34;
    Read recorded fields as `viewer.rec.&lt;name&gt;`.
    Accessing `rec` without having started a recording using `Viewer.range()` raises an `AssertionError`.
    &#34;&#34;&#34;
    assert self._rec, &#34;Enable recording by calling range() with a dimension name, e.g. &#39;range(frames=10)&#39;.&#34;
    return self._rec</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="phi.vis.Viewer.range"><code class="name flex">
<span>def <span class="ident">range</span></span>(<span>self, *args, warmup=0, **rec_dim)</span>
</code></dt>
<dd>
<div class="desc"><p>Similarly to <code>range()</code>, returns a generator that can be used in a <code>for</code> loop.</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; for step in ModuleViewer().range(100):
&gt;&gt;&gt;     print(f'Running step {step}')
</code></pre>
<p>However, <code><a title="phi.vis.Viewer.range" href="#phi.vis.Viewer.range">Viewer.range()</a></code> enables controlling the flow via the user interface.
Each element returned by the generator waits for <code>progress</code> to be invoked once.</p>
<p>Note that <code>step</code> is always equal to <code>Viewer.steps</code>.</p>
<p>This method can be invoked multiple times.
However, do not call this method while one <code>range</code> is still active.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>*args</code></strong></dt>
<dd>Either no arguments for infinite loop or single <code>int</code> argument <code>stop</code>.
Must be empty if <code>rec_dim</code> is used.</dd>
<dt><strong><code>**rec_dim</code></strong></dt>
<dd>Can be used instead of <code>*args</code> to record values along a new batch dimension of this name.
The recorded values can be accessed as <code>Viewer.rec.&lt;name&gt;</code> or <code>Viewer.rec['&lt;name&gt;']</code>.</dd>
<dt><strong><code>warmup</code></strong></dt>
<dd>Number of uncounted loop iterations to perform before <code>step()</code> is invoked for the first time.</dd>
</dl>
<h2 id="yields">Yields</h2>
<p>Step count of <code><a title="phi.vis.Viewer" href="#phi.vis.Viewer">Viewer</a></code>.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="phi" href="../index.html">phi</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="phi.vis.action" href="#phi.vis.action">action</a></code></li>
<li><code><a title="phi.vis.close" href="#phi.vis.close">close</a></code></li>
<li><code><a title="phi.vis.control" href="#phi.vis.control">control</a></code></li>
<li><code><a title="phi.vis.load_scalars" href="#phi.vis.load_scalars">load_scalars</a></code></li>
<li><code><a title="phi.vis.overlay" href="#phi.vis.overlay">overlay</a></code></li>
<li><code><a title="phi.vis.plot" href="#phi.vis.plot">plot</a></code></li>
<li><code><a title="phi.vis.plot_scalars" href="#phi.vis.plot_scalars">plot_scalars</a></code></li>
<li><code><a title="phi.vis.savefig" href="#phi.vis.savefig">savefig</a></code></li>
<li><code><a title="phi.vis.show" href="#phi.vis.show">show</a></code></li>
<li><code><a title="phi.vis.smooth" href="#phi.vis.smooth">smooth</a></code></li>
<li><code><a title="phi.vis.view" href="#phi.vis.view">view</a></code></li>
<li><code><a title="phi.vis.write_image" href="#phi.vis.write_image">write_image</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="phi.vis.Viewer" href="#phi.vis.Viewer">Viewer</a></code></h4>
<ul class="">
<li><code><a title="phi.vis.Viewer.range" href="#phi.vis.Viewer.range">range</a></code></li>
<li><code><a title="phi.vis.Viewer.rec" href="#phi.vis.Viewer.rec">rec</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
